(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2fcb498c"],{"1af6":function(t,e,n){var o=n("63b6");o(o.S,"Array",{isArray:n("9003")})},"2d63":function(t,e,n){"use strict";var o=n("67bb"),a=n.n(o),i=n("5d58"),r=n.n(i),l=n("a745"),c=n.n(l),s=n("774e"),u=n.n(s);function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function d(t,e){if(t){if("string"===typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?u()(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function m(t,e){var n="undefined"!==typeof a.a&&t[r.a]||t["@@iterator"];if(!n){if(c()(t)||(n=d(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,l=t},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(u)throw l}}}}n.d(e,"a",(function(){return m}))},"549b":function(t,e,n){"use strict";var o=n("d864"),a=n("63b6"),i=n("241e"),r=n("b0dc"),l=n("3702"),c=n("b447"),s=n("20fd"),u=n("7cd6");a(a.S+a.F*!n("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,a,p,d=i(t),m="function"==typeof this?this:Array,f=arguments.length,h=f>1?arguments[1]:void 0,b=void 0!==h,v=0,g=u(d);if(b&&(h=o(h,f>2?arguments[2]:void 0,2)),void 0==g||m==Array&&l(g))for(e=c(d.length),n=new m(e);e>v;v++)s(n,v,b?h(d[v],v):d[v]);else for(p=g.call(d),n=new m;!(a=p.next()).done;v++)s(n,v,b?r(p,h,[a.value,v],!0):a.value);return n.length=v,n}})},"5d58":function(t,e,n){t.exports=n("d8d6")},"67bb":function(t,e,n){t.exports=n("f921")},"774e":function(t,e,n){t.exports=n("d2d5")},a745:function(t,e,n){t.exports=n("f410")},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},da5e:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.onGroupAdd}},[t._v("添加模板组")]),t._v(" "),n("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t._l(t.groupData,(function(e){return n("el-tab-pane",{key:e.id,attrs:{name:""+e.id,label:e.groupName}},[n("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n        "+t._s(e.groupName)+"\n        "),n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.id===t.currentTab.id,expression:"item.id === currentTab.id"}],staticStyle:{"margin-left":"5px"},attrs:{trigger:"click"},on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[n("el-tooltip",{attrs:{placement:"top",content:"更多操作","open-delay":500}},[n("a",{staticClass:"el-icon-setting el-icon--right"})])],1),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{icon:"el-icon-edit",command:t.onGroupInfoUpdate}},[t._v("修改")]),t._v(" "),n("el-dropdown-item",{attrs:{icon:"el-icon-delete",command:t.onGroupInfoDelete}},[t._v("删除")])],1)],1)],1)])})),t._v(" "),n("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"text",size:"mini",icon:"el-icon-plus"},on:{click:t.onAdd}},[t._v("新增模板")]),t._v(" "),n("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"text",size:"mini",icon:"el-icon-upload2"},on:{click:t.onImportTemplates}},[t._v("批量导入")]),t._v(" "),n("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"text",size:"mini",icon:"el-icon-download"},on:{click:t.downloadTemplates}},[t._v("导出模板")]),t._v(" "),n("el-table",{attrs:{data:t.tableData,border:"","highlight-current-row":""}},[n("el-table-column",{attrs:{prop:"name",label:"模板名称",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"fileName",label:"文件名称"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return t.onTableUpdate(e.row)}}},[t._v("修改")]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return t.onTableCopy(e.row)}}},[t._v("复制")]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return t.onTableDelete(e.row)}}},[t._v("删除")])]}}])})],1)],2),t._v(" "),n("el-dialog",{attrs:{title:"批量导入模板",visible:t.importDialogVisible,"close-on-press-escape":!1,"close-on-click-modal":!1},on:{"update:visible":function(e){t.importDialogVisible=e},closed:t.onImportDialogClosed}},[t.importLoading?t._e():n("el-upload",{attrs:{drag:"",multiple:"",accept:".txt,.vm",action:"http://xx.nothing",limit:20,"show-file-list":!1,"http-request":t.uploadTemplates}},[n("i",{staticClass:"el-icon-upload"}),t._v(" "),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])])]),t._v(" "),t.importLoading?n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.importFiles}},[n("el-table-column",{attrs:{prop:"name",label:"文件",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"state",label:"状态"}})],1):t._e()],1)],1)},a=[],i=(n("ac6a"),n("96cf"),n("3b8d")),r=(n("7f7f"),n("2d63")),l=n("c4e3"),c=n.n(l),s=n("21a6"),u="gen.cur.groupid",p={data:function(){return{activeName:"",tableData:[],groupData:[],currentTab:{id:0},importDialogVisible:!1,importLoading:!1,importFiles:[]}},created:function(){this.reload()},methods:{reload:function(){var t=this.getAttr(u);t&&(this.currentTab.id=parseInt(t)),this.loadGroup()},loadGroup:function(){this.post("/group/list",{},(function(t){this.groupData=t.data;var e=this.currentTab.id;!e&&this.groupData.length>0&&(e=this.groupData[0].id),e&&this.selectTab(e)}))},selectTab:function(t){var e,n=Object(r["a"])(this.groupData);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.id===t){this.currentTab=o;break}}}catch(a){n.e(a)}finally{n.f()}this.loadTable(t)},loadTable:function(t){this.setAttr(u,t),this.activeName="".concat(t),this.post("/template/list?groupId=".concat(t),{},(function(t){this.tableData=t.data}))},handleClick:function(t){var e=parseInt(t.name);e&&this.selectTab(parseInt(e))},onTableUpdate:function(t){this.goRoute("edit/".concat(t.id))},onTableCopy:function(t){var e=this,n=this.currentTab;this.groupTitle="确认要复制【".concat(t.name,"】吗？"),this.$prompt("请输入复制后的模板名称","复制模板",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name+" Copy",inputPattern:/^.{1,64}$/,inputErrorMessage:"不能为空且长度在64以内"}).then((function(o){var a=o.value;if(a!==t.name){var i={name:a,id:t.id,groupName:n.groupName,groupId:n.groupId};e.post("/template/copy",i,(function(t){e.reload()}))}else e.tip("名称不能重复","error")})).catch((function(){}))},onTableDelete:function(t){this.confirm("确认要删除【".concat(t.name,"】吗？"),(function(e){this.post("/template/del",t,(function(){e(),this.tip("删除成功"),this.reload()}))}))},onAdd:function(){this.goRoute("edit/0?groupId=".concat(this.currentTab.id))},onGroupInfoUpdate:function(){this.onGroupUpdate(this.currentTab)},onGroupInfoDelete:function(){this.onGroupDelete(this.currentTab)},onGroupAdd:function(){var t=this;this.groupTitle="增加模板组",this.$prompt("请输入组名称","增加模板组",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:"",inputPattern:/^.{1,64}$/,inputErrorMessage:"不能为空且长度在64以内"}).then((function(e){var n=e.value,o={groupName:n};t.post("/group/add",o,(function(e){t.currentTab=e.data,t.reload()}))})).catch((function(){}))},onGroupUpdate:function(t){var e=this;this.$prompt("请输入组名称","修改模板组",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.groupName,inputPattern:/^.{1,64}$/,inputErrorMessage:"不能为空且长度在64以内"}).then((function(n){var o=n.value,a={id:t.id,groupName:o};e.post("/group/update",a,(function(t){e.reload()}))})).catch((function(){}))},onGroupDelete:function(t){this.confirm("确认要删除【".concat(t.groupName,"】吗？"),(function(e){this.post("/group/del",t,(function(){e(),this.tip("删除成功"),this.currentTab.id=0,this.reload()}))}))},onImportTemplates:function(){this.importFiles=[],this.importLoading=!1,this.importDialogVisible=!0},onImportDialogClosed:function(){this.currentTab&&this.loadTable(this.currentTab.id)},uploadTemplates:function(t){var e=this;this.importLoading=!0;var n=t.file;this.importFiles.push({name:n.name,state:"上传中..."});var o=new FileReader;return o.readAsText(n),o.onloadend=Object(i["a"])(regeneratorRuntime.mark((function t(){var a,i,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=o.result,i=n.name,r=i.lastIndexOf("."),-1!==r&&(i=i.substring(0,r)),l={groupId:e.currentTab.id,groupName:e.currentTab.groupName,name:i,content:a},t.next=7,e.saveTemplate(l);case 7:e.importFiles.forEach((function(t){t.name===n.name&&(t.state="成功")}));case 8:case"end":return t.stop()}}),t)}))),!0},saveTemplate:function(t){var e="/template/save";this.post(e,t)},downloadTemplates:function(){var t=this.currentTab.groupName,e=t+".zip",n=new c.a,o=n.folder(t);this.tableData.forEach((function(t){o.file(t.name+".vm",t.content)})),n.generateAsync({type:"blob"}).then((function(t){Object(s["saveAs"])(t,e)}))}}},d=p,m=n("2877"),f=Object(m["a"])(d,o,a,!1,null,null,null);e["default"]=f.exports},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray}}]);